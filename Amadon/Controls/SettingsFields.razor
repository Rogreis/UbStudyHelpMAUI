@using AmadonStandardLib.Classes;
@using System.Diagnostics;
@using AmadonStandardLib.Helpers;
<div class="row">
    <div class="col-sm-4">
        <SwitchControl LabelText="Show Middle Translation" IsToggled=@parameters.ShowMiddle />
    </div>
    <div class="col-sm-4">
        <SwitchControl LabelText="Show Right Translation" IsToggled=@parameters.ShowRight />
    </div>
    <div class="col-sm-4">
        <SwitchControl LabelText="Show Compare" IsToggled=@parameters.ShowCompare />
    </div>
</div>

<div class="row">
    <div class="col-sm-4">
        <SwitchControl LabelText="Dark Mode" IsToggled=@parameters.UseDarkThemme />
    </div>
    <div class="col-sm-4">
        <SwitchControl @ref=SwitchParNumber LabelText="Show Paragraph Numnber" IsToggled=@parameters.ShowParagraphIdentification/>
    </div>
    <div class="col-sm-4">
        <SwitchControl LabelText="Use Serif Font" IsToggled=@parameters.ShowCompare />
    </div>
</div>


<div class="row">
    <div class="col-sm-4">
        <TranslationListControl @ref="leftTranslationCombo" Title="Left Translation" ComboValue="0"></TranslationListControl>
    </div>
    <div class="col-sm-4">
        <TranslationListControl @ref="middleTranslationCombo" Title="Middle Translation" ComboValue="37"></TranslationListControl>
    </div>
    <div class="col-sm-4">
        <TranslationListControl @ref="rightTranslationCombo" Title="Right Translation" ComboValue="34"></TranslationListControl>
    </div>
</div>

<div class="row">
    <div class="col-sm-4">
        <NumberControl LabelText="Search Page Size" MinValue="10" MaxValue="100" Value=@parameters.SearchPageSize></NumberControl>
    </div>
    <div class="col-sm-4">
        <NumberControl LabelText="Max Search Expression Stored" MinValue="10" MaxValue="100" Value=@parameters.MaxExpressionsStored></NumberControl>
    </div>
    <div class="col-sm-4">
        <NumberControl LabelText="Font Size" MinValue="10" MaxValue="30" Value=@parameters.FontSize></NumberControl>
    </div>
</div>


<div class="row">
    <div class="col-sm-6">
        <button class="btn btn-primary" @onclick="OpenLocalRepository">Local Translation Repository</button>
    </div>
    <div class="col-sm-6">
        <button class="btn btn-primary" @onclick="OpenHelp">Open Help</button>
    </div>
</div>


@code {

    private Parameters parameters = new Parameters();

    private TranslationListControl leftTranslationCombo;
    private TranslationListControl middleTranslationCombo;
    private TranslationListControl rightTranslationCombo;

    private SwitchControl SwitchParNumber;

    private bool Initialized = false;

    //protected override async Task OnInitializedAsync()
    //{
    //    await base.OnInitializedAsync();
    //}

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            // Wait for the button to be rendered
            StateHasChanged();
        }

        if (!Initialized)
        {
            await Task.Delay(1);
            SwitchParNumber.FieldChanged += SwitchParNumber_FieldChanged;
            Initialized = true;
        }
    }

    private void SwitchParNumber_FieldChanged(object value)
    {
        parameters.ShowParagraphIdentification= (bool)value;
    }

    private Task OpenLocalRepository()
    {
       //Process.Start(parameters.TUB_Files_RepositoryFolder);
        return Task.CompletedTask;
    }


    private Task OpenHelp()
    {
        //Process.Start("https://github.com/Rogreis/UbStudyHelpMAUI");
        return Task.CompletedTask;
    }

    private void ThemeChanged(bool isToggled)
    {
        parameters.UseDarkThemme = isToggled;
    }

    public void Initialize()
    {
        parameters = StaticObjects.Parameters;
        leftTranslationCombo.SetValue(parameters.LanguageIDLeftTranslation);
        middleTranslationCombo.SetValue(parameters.LanguageIDMiddleTranslation);
        rightTranslationCombo.SetValue(parameters.LanguageIDRightTranslation);
    }

}
